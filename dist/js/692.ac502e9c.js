"use strict";(self["webpackChunktravelholic"]=self["webpackChunktravelholic"]||[]).push([[692],{8892:function(e,t,a){a.d(t,{Z:function(){return y}});var o=a(3396),n=a(7139),l=a(9242);const i={class:"modal",tabindex:"-1",ref:"modal"},s={class:"modal-dialog"},d={class:"modal-content"},p={class:"modal-header bg-danger text-white"},u={class:"modal-title"},c=["disabled"],r={class:"modal-body"},h={class:"modal-footer"},m=["disabled"],_=["disabled"];function b(e,t,a,b,g,C){return(0,o.wg)(),(0,o.iD)("div",i,[(0,o._)("div",s,[(0,o._)("div",d,[(0,o._)("div",p,[(0,o._)("h5",u,"是否刪除 "+(0,n.zw)(a.title),1),(0,o._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",disabled:g.btnDisabled},null,8,c)]),(0,o._)("div",r,[(0,o._)("p",null,"確定要刪除 "+(0,n.zw)(a.title)+" 嗎？（刪除後無法恢復）",1)]),(0,o._)("div",h,[(0,o._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal",disabled:g.btnDisabled}," 取消 ",8,m),(0,o._)("button",{type:"button",class:"btn btn-danger",disabled:g.btnDisabled,onClick:t[0]||(t[0]=(0,l.iM)(((...e)=>C.deleteItem&&C.deleteItem(...e)),["prevent"]))},"確認刪除",8,_)])])])],512)}var g=a(7972),C=a.n(g),v={props:["title"],data(){return{modal:{},btnDisabled:!1}},methods:{showModal(){this.btnDisabled=!1,this.modal.show()},hideModal(){this.modal.hide()},deleteItem(){this.btnDisabled=!0,this.$emit("delete-item")}},mounted(){this.modal=new(C())(this.$refs.modal)}},f=a(89);const w=(0,f.Z)(v,[["render",b]]);var y=w},6832:function(e,t,a){a.d(t,{Z:function(){return w}});var o=a(3396),n=a(7139),l=a(9242);const i={"aria-label":"Page navigation"},s={class:"pagination justify-content-center"},d=(0,o._)("span",{"aria-hidden":"true"},"«",-1),p=[d],u=(0,o._)("span",{"aria-hidden":"true"},"‹",-1),c=[u],r=["onClick"],h=(0,o._)("span",{"aria-hidden":"true"},"›",-1),m=[h],_=(0,o._)("span",{"aria-hidden":"true"},"»",-1),b=[_];function g(e,t,a,d,u,h){return(0,o.wg)(),(0,o.iD)("nav",i,[(0,o._)("ul",s,[(0,o._)("li",{class:(0,n.C_)(["page-item",{disabled:!a.pagination.has_pre}])},[(0,o._)("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:t[0]||(t[0]=(0,l.iM)((e=>h.updatePage(1)),["prevent"]))},p)],2),(0,o._)("li",{class:(0,n.C_)(["page-item",{disabled:!a.pagination.has_pre}])},[(0,o._)("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:t[1]||(t[1]=(0,l.iM)((e=>h.updatePage(a.pagination.current_page-1)),["prevent"]))},c)],2),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(a.pagination.total_pages,(e=>((0,o.wg)(),(0,o.iD)("li",{class:"page-item",key:e},[(0,o._)("a",{class:(0,n.C_)(["page-link",{active:e===a.pagination.current_page}]),href:"#",onClick:(0,l.iM)((t=>h.updatePage(e)),["prevent"])},(0,n.zw)(e),11,r)])))),128)),(0,o._)("li",{class:(0,n.C_)(["page-item",{disabled:!a.pagination.has_next}])},[(0,o._)("a",{class:"page-link",href:"#","aria-label":"Next",onClick:t[2]||(t[2]=(0,l.iM)((e=>h.updatePage(a.pagination.current_page+1)),["prevent"]))},m)],2),(0,o._)("li",{class:(0,n.C_)(["page-item",{disabled:!a.pagination.has_next}])},[(0,o._)("a",{class:"page-link",href:"#","aria-label":"Next",onClick:t[3]||(t[3]=(0,l.iM)((e=>h.updatePage(a.pagination.total_pages)),["prevent"]))},b)],2)])])}var C={props:{pagination:{type:Object}},methods:{updatePage(e){this.$emit("update-page",e)}}},v=a(89);const f=(0,v.Z)(C,[["render",g]]);var w=f},2692:function(e,t,a){a.r(t),a.d(t,{default:function(){return O}});var o=a(3396),n=a(9242),l=a(7139);const i={class:"text-end mt-3"},s={class:"table"},d=(0,o._)("thead",null,[(0,o._)("tr",null,[(0,o._)("th",null,"優惠券名稱"),(0,o._)("th",null,"優惠碼"),(0,o._)("th",null,"折扣百分比"),(0,o._)("th",null,"到期日"),(0,o._)("th",null,"啟用"),(0,o._)("th",null,"編輯")])],-1),p={key:0,class:"text-success"},u={key:1,class:"text-secondary"},c=["onClick"],r=["onClick"];function h(e,t,a,h,m,_){const b=(0,o.up)("Loading"),g=(0,o.up)("CouponModal"),C=(0,o.up)("DeleteModal"),v=(0,o.up)("Pagination");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(b,{active:m.isLoading,style:{"z-index":"9999"}},null,8,["active"]),(0,o._)("div",i,[(0,o._)("button",{class:"btn btn-primary",onClick:t[0]||(t[0]=(0,n.iM)((e=>_.openModal(!0)),["prevent"]))},"新增優惠券")]),(0,o._)("table",s,[d,(0,o._)("tbody",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(m.coupons,((e,t)=>((0,o.wg)(),(0,o.iD)("tr",{key:t},[(0,o._)("td",null,(0,l.zw)(e.title),1),(0,o._)("td",null,(0,l.zw)(e.code),1),(0,o._)("td",null,(0,l.zw)(e.percent),1),(0,o._)("td",null,(0,l.zw)(new Date(1e3*e.due_date).toLocaleDateString()),1),(0,o._)("td",null,[e.is_enabled?((0,o.wg)(),(0,o.iD)("span",p,"啟用")):((0,o.wg)(),(0,o.iD)("span",u,"未啟用"))]),(0,o._)("td",null,[(0,o._)("button",{class:"btn btn-outline-primary btn-sm",onClick:(0,n.iM)((t=>_.openModal(!1,e)),["prevent"])},"編輯",8,c),(0,o._)("button",{class:"btn btn-outline-danger btn-sm",onClick:(0,n.iM)((t=>_.openDeleteModal(e)),["prevent"])},"刪除",8,r)])])))),128))])]),(0,o.Wm)(g,{ref:"couponModal",coupon:m.tempCoupon,onUpdateCoupon:_.updateCoupon},null,8,["coupon","onUpdateCoupon"]),(0,o.Wm)(C,{ref:"deleteModal",title:m.tempCoupon.title,onDeleteItem:_.deleteCoupon},null,8,["title","onDeleteItem"]),(0,o.Wm)(v,{pagination:m.pagination,onUpdatePage:_.getCoupons},null,8,["pagination","onUpdatePage"])],64)}const m={class:"modal",tabindex:"-1",ref:"modal"},_={class:"modal-dialog"},b={class:"modal-content"},g=(0,o._)("div",{class:"modal-header"},[(0,o._)("h5",{class:"modal-title"},"編輯優惠券"),(0,o._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),C={class:"modal-body"},v={class:"mb-3"},f=(0,o._)("label",{for:"title",class:"form-label"},"優惠券名稱",-1),w={class:"mb-3"},y=(0,o._)("label",{for:"code",class:"form-label"},"優惠碼",-1),M={class:"mb-3"},k=(0,o._)("label",{for:"percent",class:"form-label"},"優惠百分比",-1),D={class:"mb-3"},x=(0,o._)("label",{for:"due_date",class:"form-label"},"到期日",-1),$={class:"modal-footer justify-content-between"},P={class:"form-check"},L=(0,o._)("label",{for:"is_enabled",class:"form-check-label"},"是否啟用",-1),U=(0,o._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function z(e,t,a,l,i,s){return(0,o.wg)(),(0,o.iD)("div",m,[(0,o._)("div",_,[(0,o._)("div",b,[g,(0,o._)("div",C,[(0,o._)("div",v,[f,(0,o.wy)((0,o._)("input",{type:"text",id:"title",class:"form-control","onUpdate:modelValue":t[0]||(t[0]=e=>i.tempCoupon.title=e)},null,512),[[n.nr,i.tempCoupon.title]])]),(0,o._)("div",w,[y,(0,o.wy)((0,o._)("input",{type:"text",id:"code",class:"form-control","onUpdate:modelValue":t[1]||(t[1]=e=>i.tempCoupon.code=e)},null,512),[[n.nr,i.tempCoupon.code]])]),(0,o._)("div",M,[k,(0,o.wy)((0,o._)("input",{type:"number",id:"percent",class:"form-control","onUpdate:modelValue":t[2]||(t[2]=e=>i.tempCoupon.percent=e)},null,512),[[n.nr,i.tempCoupon.percent]])]),(0,o._)("div",D,[x,(0,o.wy)((0,o._)("input",{type:"date",id:"due_date",class:"form-control","onUpdate:modelValue":t[3]||(t[3]=e=>i.due_date=e)},null,512),[[n.nr,i.due_date]])])]),(0,o._)("div",$,[(0,o._)("div",P,[(0,o.wy)((0,o._)("input",{type:"checkbox",id:"is_enabled",class:"form-check-input","true-value":1,"false-value":0,"onUpdate:modelValue":t[4]||(t[4]=e=>i.tempCoupon.is_enabled=e)},null,512),[[n.e8,i.tempCoupon.is_enabled]]),L]),(0,o._)("div",null,[U,(0,o._)("button",{type:"button",class:"btn btn-primary ms-2",onClick:t[5]||(t[5]=t=>e.$emit("update-coupon",i.tempCoupon))},"確定編輯")])])])])],512)}var Z=a(7972),I=a.n(Z),N={props:{coupon:{}},data(){return{modal:{},tempCoupon:{is_enabled:0},due_date:""}},watch:{coupon(){this.tempCoupon=this.coupon;const e=new Date(1e3*this.tempCoupon.due_date).toISOString().split("T");this.due_date=e[0]},due_date(){this.tempCoupon.due_date=new Date(this.due_date)/1e3}},methods:{showModal(){this.modal.show()},hideModal(){this.modal.hide()}},mounted(){this.modal=new(I())(this.$refs.modal)}},V=a(89);const W=(0,V.Z)(N,[["render",z]]);var j=W,H=a(8892),S=a(6832),Y={data(){return{coupons:{},pagination:{},tempCoupon:{},isLoading:!1,isNew:!1}},components:{CouponModal:j,DeleteModal:H.Z,Pagination:S.Z},methods:{getCoupons(e=1){this.isLoading=!0;const t=`https://vue3-course-api.hexschool.io/api/yanni-hexschool-api/admin/coupons?page=${e}`;this.$http.get(t).then((e=>{this.isLoading=!1,console.log(e.data),this.coupons=e.data.coupons,this.pagination=e.data.pagination}))},openModal(e,t){this.tempCoupon=e?{due_date:(new Date).getTime()/1e3,is_enabled:0}:{...t},this.isNew=e,this.$refs.couponModal.showModal()},updateCoupon(e){this.isLoading=!0,this.tempCoupon=e;let t="https://vue3-course-api.hexschool.io/api/yanni-hexschool-api/admin/coupon",a="post";this.isNew||(t=`https://vue3-course-api.hexschool.io/api/yanni-hexschool-api/admin/coupon/${this.tempCoupon.id}`,a="put"),this.$http[a](t,{data:this.tempCoupon}).then((e=>{this.isLoading=!1,console.log(e.data),this.$refs.couponModal.hideModal(),this.getCoupons()}))},openDeleteModal(e){this.tempCoupon={...e},this.$refs.deleteModal.showModal()},deleteCoupon(){this.isLoading=!0;const e=`https://vue3-course-api.hexschool.io/api/yanni-hexschool-api/admin/coupon/${this.tempCoupon.id}`;this.$http.delete(e).then((e=>{this.isLoading=!1,console.log(e.data),this.$refs.deleteModal.hideModal(),this.getCoupons()}))}},created(){this.getCoupons()}};const K=(0,V.Z)(Y,[["render",h]]);var O=K}}]);
//# sourceMappingURL=692.ac502e9c.js.map